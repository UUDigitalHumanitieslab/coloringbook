{#
	(c) 2014 Digital Humanities Lab, Faculty of Humanities, Utrecht University
	Author: Julian Gonggrijp, j.gonggrijp@uu.nl
#}

{% macro hide() %}
	<div style="display: none;">
		{{ caller() }}
	</div>
{% endmacro %}

{% macro enable_select2multiple() %}
	<script>
		(function() {
			var input, data, binder = this;
			function enable(self, choices) {
				self.select2({
					data: choices,
					multiple: true,
					sortable: true,
					width: '220px',
				});
				self.on("change", function() {
					$("#" + self.id + "_val").html(self.val());
				});
				self.select2("container").find("ul.select2-choices").sortable({
					containment: 'parent',
					start: function() { self.select2("onSortStart"); },
					update: function() { self.select2("onSortEnd"); },
				});
			}
			$('input[data-choices]').each(function() {
				input = $(this);
				data = input.data();
				if (data.choices) {
					enable(input, data.choices);
				} else if (data.fetch) {
					$.get(data.fetch).then(enable.bind(binder, input));
				}
			});
		}());
	</script>
{% endmacro %}
